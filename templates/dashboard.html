<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Your ZenPDF Dashboard">
    <title>Dashboard - ZenPDF</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="{{ url_for('home') }}" class="nav-brand">ðŸ“„ ZenPDF</a>
            <ul class="nav-menu">
                <li class="nav-item active"><a href="{{ url_for('dashboard') }}">Dashboard</a></li>
                <li class="nav-item"><a href="{{ url_for('split_pdf') }}">Split PDF</a></li>
                <li class="nav-item"><a href="{{ url_for('merge_pdf') }}">Merge PDF</a></li>
                <li class="nav-item"><a href="{{ url_for('compress_pdf') }}">Compress PDF</a></li>
                <li class="nav-item"><a href="{{ url_for('rotate_pdf') }}">Rotate PDF</a></li>
                <li class="nav-item"><a href="{{ url_for('auth.logout') }}">Logout</a></li>
            </ul>
            <button class="nav-toggle" id="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <div class="container">
        <main class="content" style="max-width: 1000px; margin: 0 auto;">
            <div class="header-content">
                <h1>Welcome, {{ current_user.username }}!</h1>
                <p class="subtitle">
                    {% if current_user.is_premium %}
                        <span style="background: #00b894; color: white; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">
                            PREMIUM USER
                        </span>
                    {% else %}
                        <span style="background: #6c5ce7; color: white; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600;">
                            FREE TIER
                        </span>
                    {% endif %}
                </p>
            </div>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Usage Stats -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px;">
                <div class="upload-section" style="padding: 30px; text-align: center;">
                    <h3 style="font-size: 40px; margin: 0; color: #6c5ce7;">{{ daily_usage }}</h3>
                    <p style="color: #666; margin-top: 10px;">
                        {% if current_user.is_premium %}
                            Operations Today (Unlimited)
                        {% else %}
                            Operations Today (5/day limit)
                        {% endif %}
                    </p>
                </div>

                <div class="upload-section" style="padding: 30px; text-align: center;">
                    <h3 style="font-size: 40px; margin: 0; color: #00b894;">{{ monthly_usage }}</h3>
                    <p style="color: #666; margin-top: 10px;">Operations This Month</p>
                </div>

                <div class="upload-section" style="padding: 30px; text-align: center;">
                    <h3 style="font-size: 40px; margin: 0; color: #fdcb6e;">
                        {% if current_user.is_premium %}
                            âˆž
                        {% else %}
                            {{ 5 - daily_usage }}
                        {% endif %}
                    </h3>
                    <p style="color: #666; margin-top: 10px;">Remaining Today</p>
                </div>
            </div>

            <!-- Upgrade Banner for Free Users -->
            {% if not current_user.is_premium %}
            <div class="upload-section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; margin-bottom: 40px; text-align: center; border-radius: 12px;">
                <h2 style="margin: 0 0 15px 0; font-size: 28px;">Upgrade to Premium</h2>
                <p style="margin: 0 0 25px 0; font-size: 18px; opacity: 0.9;">
                    Unlimited operations â€¢ 100MB file size â€¢ Priority support
                </p>
                <a href="{{ url_for('pricing') }}" class="btn" style="background: white; color: #667eea; padding: 14px 40px; font-weight: 600; font-size: 16px; display: inline-block; text-decoration: none; border-radius: 8px;">
                    View Pricing
                </a>
            </div>
            {% endif %}

            <!-- Recent Activity -->
            <div class="upload-section" style="padding: 30px;">
                <h2 style="margin-top: 0;">Recent Activity</h2>

                {% if recent_operations %}
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 2px solid #eee;">
                                <th style="padding: 12px; text-align: left; color: #666; font-weight: 600;">Operation</th>
                                <th style="padding: 12px; text-align: left; color: #666; font-weight: 600;">Date</th>
                                <th style="padding: 12px; text-align: left; color: #666; font-weight: 600;">Pages</th>
                                <th style="padding: 12px; text-align: left; color: #666; font-weight: 600;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for operation in recent_operations %}
                            <tr style="border-bottom: 1px solid #f1f1f1;">
                                <td style="padding: 12px;">
                                    <span style="text-transform: capitalize; font-weight: 600;">{{ operation.operation_type }}</span>
                                </td>
                                <td style="padding: 12px; color: #666;">
                                    {{ operation.created_at.strftime('%b %d, %Y %I:%M %p') }}
                                </td>
                                <td style="padding: 12px; color: #666;">
                                    {{ operation.pages_processed or 'N/A' }}
                                </td>
                                <td style="padding: 12px;">
                                    {% if operation.success %}
                                        <span style="color: #00b894; font-weight: 600;">âœ“ Success</span>
                                    {% else %}
                                        <span style="color: #d63031; font-weight: 600;">âœ— Failed</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p style="text-align: center; color: #999; padding: 40px 20px;">
                    No operations yet. Start by using our PDF tools!
                </p>
                {% endif %}
            </div>

            <!-- Account Info -->
            <div class="upload-section" style="padding: 30px; margin-top: 20px;">
                <h2 style="margin-top: 0;">Account Information</h2>
                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px;">
                    <div style="font-weight: 600; color: #666;">Email:</div>
                    <div>{{ current_user.email }}</div>

                    <div style="font-weight: 600; color: #666;">Username:</div>
                    <div>{{ current_user.username }}</div>

                    <div style="font-weight: 600; color: #666;">Member Since:</div>
                    <div>{{ current_user.created_at.strftime('%B %d, %Y') }}</div>

                    <div style="font-weight: 600; color: #666;">Subscription:</div>
                    <div style="text-transform: capitalize;">{{ current_user.subscription_tier }}</div>
                </div>
            </div>
        </main>
    </div>

    <footer class="footer">
        <p>&copy; 2024 ZenPDF. All rights reserved.</p>
    </footer>

    <script>
        // Mobile navigation toggle
        document.getElementById('nav-toggle').addEventListener('click', function() {
            document.querySelector('.nav-menu').classList.toggle('active');
        });
    </script>
</body>
</html>
