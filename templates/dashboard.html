<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Your ZenPDF Dashboard">
    <title>Dashboard - ZenPDF</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='output.css') }}">
</head>
<body class="min-h-screen flex flex-col bg-gray-50">
    <!-- Navigation Bar -->
    <nav class="sticky top-0 z-50 bg-white border-b border-gray-100 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <a href="{{ url_for('home') }}" class="text-2xl font-bold text-gray-900 no-underline">ðŸ“„ ZenPDF</a>
                <ul class="hidden md:flex space-x-1 items-center">
                    <li><a href="{{ url_for('home') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Home</a></li>
                    <li><a href="{{ url_for('split_pdf') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Split PDF</a></li>
                    <li><a href="{{ url_for('merge_pdf') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Merge PDF</a></li>
                    <li><a href="{{ url_for('compress_pdf') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Compress PDF</a></li>
                    <li><a href="{{ url_for('rotate_pdf') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Rotate PDF</a></li>
                    <li><a href="{{ url_for('pricing') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Pricing</a></li>
                    <li><span class="text-gray-300 px-2">|</span></li>
                    {% if current_user.is_authenticated %}
                        <li><a href="{{ url_for('dashboard') }}" class="px-4 py-2 rounded-lg bg-primary-light text-primary font-medium no-underline">Dashboard</a></li>
                        <li><a href="{{ url_for('auth.logout') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Logout</a></li>
                    {% else %}
                        <li><a href="{{ url_for('auth.login') }}" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Login</a></li>
                        <li><a href="{{ url_for('auth.register') }}" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors no-underline">Sign Up</a></li>
                    {% endif %}
                </ul>
                <button id="nav-toggle" class="md:hidden flex flex-col gap-1.5 p-2">
                    <span class="w-6 h-0.5 bg-gray-600 transition-all"></span>
                    <span class="w-6 h-0.5 bg-gray-600 transition-all"></span>
                    <span class="w-6 h-0.5 bg-gray-600 transition-all"></span>
                </button>
            </div>
            <!-- Mobile menu -->
            <div id="mobile-menu" class="hidden md:hidden pb-4">
                <a href="{{ url_for('home') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Home</a>
                <a href="{{ url_for('split_pdf') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Split PDF</a>
                <a href="{{ url_for('merge_pdf') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Merge PDF</a>
                <a href="{{ url_for('compress_pdf') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Compress PDF</a>
                <a href="{{ url_for('rotate_pdf') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Rotate PDF</a>
                <a href="{{ url_for('pricing') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Pricing</a>
                <div class="border-t border-gray-200 my-2"></div>
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('dashboard') }}" class="block px-4 py-2 rounded-lg bg-primary-light text-primary font-medium no-underline mb-1">Dashboard</a>
                    <a href="{{ url_for('auth.logout') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline">Logout</a>
                {% else %}
                    <a href="{{ url_for('auth.login') }}" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors no-underline mb-1">Login</a>
                    <a href="{{ url_for('auth.register') }}" class="block px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors no-underline">Sign Up</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex-grow">
        <main>
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">Welcome, {{ current_user.username }}!</h1>
                <div>
                    {% if current_user.is_premium %}
                        <span class="inline-block bg-green-500 text-white px-4 py-1 rounded-full text-sm font-semibold">
                            PREMIUM USER
                        </span>
                    {% else %}
                        <span class="inline-block bg-purple-600 text-white px-4 py-1 rounded-full text-sm font-semibold">
                            FREE TIER
                        </span>
                    {% endif %}
                </div>
            </div>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }} mb-6">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Usage Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg p-8 shadow-custom text-center">
                    <h3 class="text-5xl font-bold text-purple-600 mb-3">{{ daily_usage }}</h3>
                    <p class="text-gray-600">
                        {% if current_user.is_premium %}
                            Operations Today (Unlimited)
                        {% else %}
                            Operations Today (5/day limit)
                        {% endif %}
                    </p>
                </div>

                <div class="bg-white rounded-lg p-8 shadow-custom text-center">
                    <h3 class="text-5xl font-bold text-green-500 mb-3">{{ monthly_usage }}</h3>
                    <p class="text-gray-600">Operations This Month</p>
                </div>

                <div class="bg-white rounded-lg p-8 shadow-custom text-center">
                    <h3 class="text-5xl font-bold text-yellow-500 mb-3">
                        {% if current_user.is_premium %}
                            âˆž
                        {% else %}
                            {{ 5 - daily_usage }}
                        {% endif %}
                    </h3>
                    <p class="text-gray-600">Remaining Today</p>
                </div>
            </div>

            <!-- Upgrade Banner for Free Users -->
            {% if not current_user.is_premium %}
            <div class="bg-gradient-to-br from-purple-600 via-purple-700 to-purple-800 rounded-xl p-10 mb-8 text-center text-white shadow-custom">
                <h2 class="text-3xl md:text-4xl font-bold mb-4">Upgrade to Premium</h2>
                <p class="text-lg md:text-xl mb-6 opacity-90">
                    Unlimited operations â€¢ 100MB file size â€¢ Priority support
                </p>
                <a href="{{ url_for('pricing') }}" class="inline-block bg-white text-purple-700 px-8 py-3 rounded-lg font-semibold text-lg hover:bg-gray-100 transition-colors no-underline">
                    View Pricing
                </a>
            </div>
            {% endif %}

            <!-- Recent Activity -->
            <div class="bg-white rounded-lg p-8 shadow-custom mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Recent Activity</h2>

                {% if recent_operations %}
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="border-b-2 border-gray-200">
                                <th class="px-4 py-3 text-left text-gray-600 font-semibold">Operation</th>
                                <th class="px-4 py-3 text-left text-gray-600 font-semibold">Date</th>
                                <th class="px-4 py-3 text-left text-gray-600 font-semibold">Pages</th>
                                <th class="px-4 py-3 text-left text-gray-600 font-semibold">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for operation in recent_operations %}
                            <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">
                                <td class="px-4 py-3">
                                    <span class="capitalize font-semibold text-gray-900">{{ operation.operation_type }}</span>
                                </td>
                                <td class="px-4 py-3 text-gray-600">
                                    {{ operation.created_at.strftime('%b %d, %Y %I:%M %p') }}
                                </td>
                                <td class="px-4 py-3 text-gray-600">
                                    {{ operation.pages_processed or 'N/A' }}
                                </td>
                                <td class="px-4 py-3">
                                    {% if operation.success %}
                                        <span class="text-green-500 font-semibold">âœ“ Success</span>
                                    {% else %}
                                        <span class="text-red-500 font-semibold">âœ— Failed</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-center text-gray-400 py-12">
                    No operations yet. Start by using our PDF tools!
                </p>
                {% endif %}
            </div>

            <!-- Account Info -->
            <div class="bg-white rounded-lg p-8 shadow-custom">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Account Information</h2>
                <div class="grid grid-cols-1 sm:grid-cols-[auto_1fr] gap-4 max-w-2xl">
                    <div class="font-semibold text-gray-600">Email:</div>
                    <div class="text-gray-900">{{ current_user.email }}</div>

                    <div class="font-semibold text-gray-600">Username:</div>
                    <div class="text-gray-900">{{ current_user.username }}</div>

                    <div class="font-semibold text-gray-600">Member Since:</div>
                    <div class="text-gray-900">{{ current_user.created_at.strftime('%B %d, %Y') }}</div>

                    <div class="font-semibold text-gray-600">Subscription:</div>
                    <div class="text-gray-900 capitalize">{{ current_user.subscription_tier }}</div>
                </div>
            </div>
        </main>
    </div>

    <footer class="bg-white border-t border-gray-200 py-6 mt-auto">
        <p class="text-center text-gray-600">&copy; 2024 ZenPDF. All rights reserved.</p>
    </footer>

    <script>
        // Mobile Navigation Toggle
        const navToggle = document.getElementById('nav-toggle');
        const mobileMenu = document.getElementById('mobile-menu');

        navToggle.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
        });
    </script>
</body>
</html>
